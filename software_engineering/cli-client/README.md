# CLI client

Σε αυτόν τον φάκελο βρίσκεται η υλοποίηση του **cli-client** του API. Η υλοποίηση του cli βασίστηκε στη βιβλιοθήκη `click` της Python 3.

## Οδηγίες εγκατάστασης

1. *(προαιρετικά)* Δημιουργούμε ένα Python virtual environment και το ενεργοποιούμε. Εάν δεν κάνουμε αυτό το βήμα, το cli θα εγκατασταθεί system-wide:
```
python3 -m venv env
. env/bin/activate
```

2. Εγκαθιστούμε τον cli-client:
```
pip install .
```
Εάν θέλουμε να κάνουμε αλλαγές στο source code του cli-client ενώ αυτός έχει ήδη εγκατασταθεί (ώστε να μην χρειάζεται να τον αλλάζουμε κάθε φορά) μπορούμε να τον εγκαταστήσουμε με την εξής εντολή:
```
pip install --editable .
```
ή ισοδύναμα:
```
pip install -e .
```

3. Ο cli-client είναι πλέον διαθέσιμος (είτε στο virtual environment που φτιάξαμε στο Βήμα 1 είτε στο σύστημά μας) ως **energy_group30**.

## Οδηγίες για το testing
Για τον έλεγχο του cli-client χρησιμοποιήθηκε το `pytest`.

Για την εκτέλεση όλων των tests του cli:
1. Το API (back-end) του συστήματος πρέπει να είναι "όρθιο". Σε αντίθετη περίπτωση, στο επόμενο βήμα θα έχουμε μήνυμα λάθους και το testing δεν θα γίνει.

2. Εντός του φακέλου `cli-client` τρέχουμε το bash script `run_tests.sh`:
```
./run_tests.sh
```
Το script αυτό θα δημιουργήσει ένα Python 3 virtual environment εάν αυτό δεν υπάρχει, θα εγκαταστήσει σε αυτό τον cli-client μαζί με τα dependencies του, καθώς και το `pytest`, και στη συνέχεια, χρησιμοποιώντας το `pytest`, θα εκτελέσει τα tests που βρίσκονται στον φάκελο `tests`, τυπώνοντας ένα report των αποτελεσμάτων.

Σημειώνεται ότι το testing του cli χρησιμοποιεί την αληθινή βάση του συστήματος (σε αντίθεση με το testing του back-end), οπότε και για να επιτύχει αναμένεται η βάση να περιέχει τα testing δεδομένα (των πρώτων 10 ημερών του 2018). Παρόλα αυτά, δεν επηρεάζει την κατάσταση της βάσης. Αφού ολοκληρωθεί η εκτέλεση του `run_tests.sh`, η βάση βρίσκεται ακριβώς στην ίδια κατάσταση με πριν.

## Σημαντικές σχεδιαστικές επιλογές
- Η παράμετρος `--apikey` δεν είναι απαραίτητη. Ο cli-client διαβάζει το API token, εφόσον αυτό υπάρχει, από το αρχείο που ορίζεται από τις προδιαγραφές. Εάν η παράμετρος αυτή δοθεί, τότε χρησιμοποιείται η τιμή της, είτε υπάρχει το εν λόγω αρχείο είτε όχι.
